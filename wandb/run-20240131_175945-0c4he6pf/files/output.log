100%|██████████| 11/11 [00:00<00:00, 34.49it/s]
100%|██████████| 11/11 [00:00<00:00, 34.34it/s]
[2024-01-31 17:59:51,320][root][INFO] - using 1 gpus
the PU data is ['KA04', 'KA15', 'KA16', 'KA22', 'KA30', 'KB23', 'KB24', 'KB27', 'KI14', 'KI17', 'KI21']
the PU data is ['KA04', 'KA15', 'KA16', 'KA22', 'KA30', 'KB23', 'KB24', 'KB27', 'KI14', 'KI17', 'KI21']
--------PU Dataset:(0, 1) TL Task---------
the input kind is fft,the model kind is ResNet18
the opt infor is {'name': 'adamw', 'lr_src': 0.001, 'lr_tar': 0.001, 'lr_scheduler': 'designed', 'weight_decay_src': 0.0001, 'weight_decay_tar': 0.0001}
the data infor is {'data_name': 'PU', 'data_path': 'D:/P_new/PU_dataset', 'TL_list': [0, 1, 2], 'input_kind': 'fft', 'norm_kind': 'mean-std', 'TL_Task': [0, 1]}
the initial accc is 93.60
layer index: 2 	 total channel: 64 	 remaining channel: 45
layer index: 8 	 total channel: 64 	 remaining channel: 38
layer index: 11 	 total channel: 64 	 remaining channel: 41
layer index: 14 	 total channel: 64 	 remaining channel: 41
layer index: 17 	 total channel: 64 	 remaining channel: 42
layer index: 21 	 total channel: 128 	 remaining channel: 80
layer index: 24 	 total channel: 128 	 remaining channel: 80
layer index: 30 	 total channel: 128 	 remaining channel: 85
layer index: 33 	 total channel: 128 	 remaining channel: 75
layer index: 37 	 total channel: 256 	 remaining channel: 152
layer index: 40 	 total channel: 256 	 remaining channel: 176
layer index: 46 	 total channel: 256 	 remaining channel: 154
layer index: 49 	 total channel: 256 	 remaining channel: 134
layer index: 53 	 total channel: 512 	 remaining channel: 273
layer index: 56 	 total channel: 512 	 remaining channel: 294
layer index: 62 	 total channel: 512 	 remaining channel: 301
layer index: 65 	 total channel: 512 	 remaining channel: 313
the prune ratio is 32.92 and the acc_t is 9.09
Task: [0, 1], Iter:1/50; Accuracy_S/T = 76.62%/ 66.62%; Loss= 1.30
Task: [0, 1], Iter:2/50; Accuracy_S/T = 98.87%/ 90.62%; Loss= 0.74
Task: [0, 1], Iter:3/50; Accuracy_S/T = 99.64%/ 88.58%; Loss= 0.66
Task: [0, 1], Iter:4/50; Accuracy_S/T = 99.42%/ 88.18%; Loss= 0.64
Task: [0, 1], Iter:5/50; Accuracy_S/T = 99.93%/ 92.95%; Loss= 0.63
Task: [0, 1], Iter:6/50; Accuracy_S/T = 99.82%/ 89.53%; Loss= 0.62
Task: [0, 1], Iter:7/50; Accuracy_S/T = 99.96%/ 90.15%; Loss= 0.60
Task: [0, 1], Iter:8/50; Accuracy_S/T = 99.96%/ 90.69%; Loss= 0.60
Task: [0, 1], Iter:9/50; Accuracy_S/T = 99.96%/ 88.62%; Loss= 0.59
Task: [0, 1], Iter:10/50; Accuracy_S/T = 98.87%/ 89.13%; Loss= 0.62
Task: [0, 1], Iter:11/50; Accuracy_S/T = 100.00%/ 90.98%; Loss= 0.59
Task: [0, 1], Iter:12/50; Accuracy_S/T = 99.46%/ 92.00%; Loss= 0.63
Task: [0, 1], Iter:13/50; Accuracy_S/T = 100.00%/ 91.75%; Loss= 0.61
Task: [0, 1], Iter:14/50; Accuracy_S/T = 99.93%/ 88.80%; Loss= 0.59
Task: [0, 1], Iter:15/50; Accuracy_S/T = 99.96%/ 92.33%; Loss= 0.58
Task: [0, 1], Iter:16/50; Accuracy_S/T = 100.00%/ 90.91%; Loss= 0.58
Task: [0, 1], Iter:17/50; Accuracy_S/T = 99.96%/ 87.24%; Loss= 0.59
Task: [0, 1], Iter:18/50; Accuracy_S/T = 100.00%/ 89.56%; Loss= 0.58
Task: [0, 1], Iter:19/50; Accuracy_S/T = 100.00%/ 88.76%; Loss= 0.57
Task: [0, 1], Iter:20/50; Accuracy_S/T = 100.00%/ 88.80%; Loss= 0.58
Task: [0, 1], Iter:21/50; Accuracy_S/T = 100.00%/ 88.91%; Loss= 0.57
Task: [0, 1], Iter:22/50; Accuracy_S/T = 100.00%/ 89.16%; Loss= 0.58
Task: [0, 1], Iter:23/50; Accuracy_S/T = 100.00%/ 88.29%; Loss= 0.58
Task: [0, 1], Iter:24/50; Accuracy_S/T = 100.00%/ 90.62%; Loss= 0.57
Task: [0, 1], Iter:25/50; Accuracy_S/T = 100.00%/ 89.38%; Loss= 0.57
Task: [0, 1], Iter:26/50; Accuracy_S/T = 100.00%/ 87.49%; Loss= 0.57
Task: [0, 1], Iter:27/50; Accuracy_S/T = 100.00%/ 89.64%; Loss= 0.57
Task: [0, 1], Iter:28/50; Accuracy_S/T = 100.00%/ 89.16%; Loss= 0.57
Task: [0, 1], Iter:29/50; Accuracy_S/T = 100.00%/ 89.27%; Loss= 0.57
Task: [0, 1], Iter:30/50; Accuracy_S/T = 99.96%/ 90.33%; Loss= 0.57
Task: [0, 1], Iter:31/50; Accuracy_S/T = 99.96%/ 90.40%; Loss= 0.57
Task: [0, 1], Iter:32/50; Accuracy_S/T = 100.00%/ 88.11%; Loss= 0.57
Task: [0, 1], Iter:33/50; Accuracy_S/T = 100.00%/ 90.25%; Loss= 0.57
Task: [0, 1], Iter:34/50; Accuracy_S/T = 100.00%/ 89.89%; Loss= 0.57
Task: [0, 1], Iter:35/50; Accuracy_S/T = 100.00%/ 89.78%; Loss= 0.56
Task: [0, 1], Iter:36/50; Accuracy_S/T = 100.00%/ 92.44%; Loss= 0.56
Task: [0, 1], Iter:37/50; Accuracy_S/T = 100.00%/ 91.82%; Loss= 0.56
Task: [0, 1], Iter:38/50; Accuracy_S/T = 100.00%/ 89.67%; Loss= 0.56
Task: [0, 1], Iter:39/50; Accuracy_S/T = 100.00%/ 89.60%; Loss= 0.57
Task: [0, 1], Iter:40/50; Accuracy_S/T = 100.00%/ 90.55%; Loss= 0.56
Task: [0, 1], Iter:41/50; Accuracy_S/T = 100.00%/ 90.76%; Loss= 0.56
Task: [0, 1], Iter:42/50; Accuracy_S/T = 100.00%/ 90.87%; Loss= 0.56
Task: [0, 1], Iter:43/50; Accuracy_S/T = 100.00%/ 90.91%; Loss= 0.56
Task: [0, 1], Iter:44/50; Accuracy_S/T = 100.00%/ 91.27%; Loss= 0.56
Task: [0, 1], Iter:45/50; Accuracy_S/T = 100.00%/ 92.91%; Loss= 0.57
Task: [0, 1], Iter:46/50; Accuracy_S/T = 100.00%/ 92.73%; Loss= 0.56
Task: [0, 1], Iter:47/50; Accuracy_S/T = 100.00%/ 91.89%; Loss= 0.56
Task: [0, 1], Iter:48/50; Accuracy_S/T = 100.00%/ 92.25%; Loss= 0.57
Task: [0, 1], Iter:49/50; Accuracy_S/T = 100.00%/ 90.84%; Loss= 0.56
Task: [0, 1], Iter:50/50; Accuracy_S/T = 100.00%/ 90.36%; Loss= 0.56