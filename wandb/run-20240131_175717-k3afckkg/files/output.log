100%|██████████| 11/11 [00:00<00:00, 37.90it/s]
100%|██████████| 11/11 [00:00<00:00, 37.56it/s]
[2024-01-31 17:57:23,430][root][INFO] - using 1 gpus
the PU data is ['KA04', 'KA15', 'KA16', 'KA22', 'KA30', 'KB23', 'KB24', 'KB27', 'KI14', 'KI17', 'KI21']
the PU data is ['KA04', 'KA15', 'KA16', 'KA22', 'KA30', 'KB23', 'KB24', 'KB27', 'KI14', 'KI17', 'KI21']
--------PU Dataset:(0, 1) TL Task---------
the input kind is fft,the model kind is ResNet18
the opt infor is {'name': 'adamw', 'lr_src': 0.001, 'lr_tar': 0.001, 'lr_scheduler': 'designed', 'weight_decay_src': 0.0001, 'weight_decay_tar': 0.0001}
the data infor is {'data_name': 'PU', 'data_path': 'D:/P_new/PU_dataset', 'TL_list': [0, 1, 2], 'input_kind': 'fft', 'norm_kind': 'mean-std', 'TL_Task': [0, 1]}
the initial accc is 93.60
layer index: 2 	 total channel: 64 	 remaining channel: 58
layer index: 8 	 total channel: 64 	 remaining channel: 52
layer index: 11 	 total channel: 64 	 remaining channel: 51
layer index: 14 	 total channel: 64 	 remaining channel: 54
layer index: 17 	 total channel: 64 	 remaining channel: 55
layer index: 21 	 total channel: 128 	 remaining channel: 101
layer index: 24 	 total channel: 128 	 remaining channel: 105
layer index: 30 	 total channel: 128 	 remaining channel: 103
layer index: 33 	 total channel: 128 	 remaining channel: 104
layer index: 37 	 total channel: 256 	 remaining channel: 214
layer index: 40 	 total channel: 256 	 remaining channel: 218
layer index: 46 	 total channel: 256 	 remaining channel: 201
layer index: 49 	 total channel: 256 	 remaining channel: 199
layer index: 53 	 total channel: 512 	 remaining channel: 389
layer index: 56 	 total channel: 512 	 remaining channel: 404
layer index: 62 	 total channel: 512 	 remaining channel: 400
layer index: 65 	 total channel: 512 	 remaining channel: 409
the prune ratio is 16.40 and the acc_t is 9.16
Task: [0, 1], Iter:1/50; Accuracy_S/T = 77.86%/ 69.31%; Loss= 1.32
Task: [0, 1], Iter:2/50; Accuracy_S/T = 99.71%/ 91.31%; Loss= 0.74
Task: [0, 1], Iter:3/50; Accuracy_S/T = 99.93%/ 93.35%; Loss= 0.63
Task: [0, 1], Iter:4/50; Accuracy_S/T = 99.02%/ 86.29%; Loss= 0.63
Task: [0, 1], Iter:5/50; Accuracy_S/T = 99.96%/ 90.36%; Loss= 0.63
Task: [0, 1], Iter:6/50; Accuracy_S/T = 98.22%/ 86.07%; Loss= 0.61
Task: [0, 1], Iter:7/50; Accuracy_S/T = 100.00%/ 88.76%; Loss= 0.61
Task: [0, 1], Iter:8/50; Accuracy_S/T = 100.00%/ 95.53%; Loss= 0.62
Task: [0, 1], Iter:9/50; Accuracy_S/T = 100.00%/ 91.05%; Loss= 0.59
Task: [0, 1], Iter:10/50; Accuracy_S/T = 100.00%/ 92.87%; Loss= 0.60
Task: [0, 1], Iter:11/50; Accuracy_S/T = 100.00%/ 95.16%; Loss= 0.60
Task: [0, 1], Iter:12/50; Accuracy_S/T = 100.00%/ 94.25%; Loss= 0.60
Task: [0, 1], Iter:13/50; Accuracy_S/T = 99.96%/ 93.71%; Loss= 0.61
Task: [0, 1], Iter:14/50; Accuracy_S/T = 99.96%/ 95.20%; Loss= 0.58
Task: [0, 1], Iter:15/50; Accuracy_S/T = 100.00%/ 93.60%; Loss= 0.58
Task: [0, 1], Iter:16/50; Accuracy_S/T = 100.00%/ 92.40%; Loss= 0.57
Task: [0, 1], Iter:17/50; Accuracy_S/T = 100.00%/ 92.55%; Loss= 0.59
Task: [0, 1], Iter:18/50; Accuracy_S/T = 100.00%/ 95.35%; Loss= 0.57
Task: [0, 1], Iter:19/50; Accuracy_S/T = 100.00%/ 95.60%; Loss= 0.57
Task: [0, 1], Iter:20/50; Accuracy_S/T = 100.00%/ 94.76%; Loss= 0.57
Task: [0, 1], Iter:21/50; Accuracy_S/T = 100.00%/ 93.71%; Loss= 0.57
Task: [0, 1], Iter:22/50; Accuracy_S/T = 100.00%/ 95.96%; Loss= 0.57
Task: [0, 1], Iter:23/50; Accuracy_S/T = 99.96%/ 93.89%; Loss= 0.58
Task: [0, 1], Iter:24/50; Accuracy_S/T = 100.00%/ 96.22%; Loss= 0.57
Task: [0, 1], Iter:25/50; Accuracy_S/T = 100.00%/ 95.49%; Loss= 0.57
Task: [0, 1], Iter:26/50; Accuracy_S/T = 100.00%/ 94.84%; Loss= 0.57
Task: [0, 1], Iter:27/50; Accuracy_S/T = 100.00%/ 94.91%; Loss= 0.56
Task: [0, 1], Iter:28/50; Accuracy_S/T = 100.00%/ 94.07%; Loss= 0.57
Task: [0, 1], Iter:29/50; Accuracy_S/T = 100.00%/ 94.91%; Loss= 0.56
Task: [0, 1], Iter:30/50; Accuracy_S/T = 100.00%/ 92.73%; Loss= 0.57
Task: [0, 1], Iter:31/50; Accuracy_S/T = 99.96%/ 95.89%; Loss= 0.57
Task: [0, 1], Iter:32/50; Accuracy_S/T = 100.00%/ 91.27%; Loss= 0.57
Task: [0, 1], Iter:33/50; Accuracy_S/T = 100.00%/ 94.25%; Loss= 0.57
Task: [0, 1], Iter:34/50; Accuracy_S/T = 100.00%/ 93.96%; Loss= 0.56
Task: [0, 1], Iter:35/50; Accuracy_S/T = 100.00%/ 94.07%; Loss= 0.56
Task: [0, 1], Iter:36/50; Accuracy_S/T = 100.00%/ 95.13%; Loss= 0.56
Task: [0, 1], Iter:37/50; Accuracy_S/T = 100.00%/ 95.09%; Loss= 0.56
Task: [0, 1], Iter:38/50; Accuracy_S/T = 100.00%/ 93.35%; Loss= 0.56
Task: [0, 1], Iter:39/50; Accuracy_S/T = 100.00%/ 94.07%; Loss= 0.58
Task: [0, 1], Iter:40/50; Accuracy_S/T = 100.00%/ 95.16%; Loss= 0.57
Task: [0, 1], Iter:41/50; Accuracy_S/T = 100.00%/ 94.65%; Loss= 0.57
Task: [0, 1], Iter:42/50; Accuracy_S/T = 100.00%/ 94.33%; Loss= 0.56
Task: [0, 1], Iter:43/50; Accuracy_S/T = 100.00%/ 94.58%; Loss= 0.57
Task: [0, 1], Iter:44/50; Accuracy_S/T = 100.00%/ 94.91%; Loss= 0.56
Task: [0, 1], Iter:45/50; Accuracy_S/T = 100.00%/ 95.02%; Loss= 0.57
Task: [0, 1], Iter:46/50; Accuracy_S/T = 100.00%/ 95.31%; Loss= 0.56
Task: [0, 1], Iter:47/50; Accuracy_S/T = 100.00%/ 94.73%; Loss= 0.56
Task: [0, 1], Iter:48/50; Accuracy_S/T = 100.00%/ 95.75%; Loss= 0.56
Task: [0, 1], Iter:49/50; Accuracy_S/T = 100.00%/ 95.05%; Loss= 0.56
Task: [0, 1], Iter:50/50; Accuracy_S/T = 100.00%/ 94.58%; Loss= 0.56